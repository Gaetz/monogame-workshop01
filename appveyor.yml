# build variables
os: Visual Studio 2015
configuration: Release
platform: Any CPU

install:
  - cinst 7zip -x86
  - cinst 7zip.commandline -x86
  - cinst xamarin-component -version 1.1.0.7
  - ps: |
      $tempDir="$pwd\temp"
      $installerUrl="http://www.monogame.net/releases/v3.5/MonoGameSetup.exe"
      $installerFile="$tempDir\MonoGameSetup.zip"
      $installerExtracted="$tempDir\MonoGameSetup"
      $programFiles = "${env:ProgramFiles(x86)}\"
      Write-Host "Downloading MonoGame to $installerFile..."
      If ((Test-Path  $tempDir) -eq 0) {
          New-Item -ItemType Directory $tempDir
      }
      Invoke-WebRequest $installerUrl -OutFile $installerFile
      Write-Host "Extracting MonoGame to $installerExtracted..."
      7z x -y $installerFile -o"$installerExtracted"
      Write-Host "Copying the MonoGame content pipeline to $programFiles..."
      Copy-Item "$installerExtracted\`$PROGRAMFILES\MSBuild\MonoGame" "$programFiles\MSBuild" -Recurse 

# build
branches:
  only:
    - master
before_build:
  - if not exist output mkdir output
  - if not exist output\net4 mkdir output\net4
  - if not exist output\Portable mkdir output\Portable
  - nuget restore BasicGeex\BasicGeex.sln
build:
  project: BasicGeex\BasicGeex.sln 
  verbosity: normal